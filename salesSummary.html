<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Sales Summary</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styleitems.css">
    <style>
        .summary-wrapper { padding: 20px; max-width: 1100px; margin: 0 auto; max-height: calc(100vh - 120px); overflow-y: auto; }
        .txn { background:#3D3D3D; padding:12px; border-radius:8px; margin-bottom:12px; }
        .txn h4 { margin:0 0 8px 0; color:#D1BFA7; }
        .txn pre { white-space: pre-wrap; color:#EFEFEF; }
        .controls { display:flex; gap:12px; margin-bottom:16px; }
    </style>
</head>
<body>
    <div class="top-bar">
        <button id="menuToggle" type="button" aria-expanded="false" aria-controls="drawer" aria-label="Open menu">‚ò∞</button>
        <div class="title">Moon Light Ice Cream Parlor</div>
    </div>

    <div class="drawer" id="drawer">
        <a href="index.html">Home</a>
        <a href="salesSummary.html">Sales Summary</a>
        <a href="#">About Us</a>
    </div>
    <div class="summary-wrapper">
        <h2>Sales Summary</h2>
        <div class="controls">
            <button id="backBtn" class="button-18">‚¨ÖÔ∏è Back</button>
            <button id="clearBtn" class="button-18">üóëÔ∏è Clear All</button>
        </div>
        <div id="list"></div>
    </div>

    <script>
        (function () {
            const drawer = document.getElementById('drawer');
            const menuToggle = document.getElementById('menuToggle');
            if (!drawer || !menuToggle) return;
            menuToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                const isOpen = drawer.classList.toggle('open');
                menuToggle.setAttribute('aria-expanded', String(isOpen));
            });
            document.addEventListener('click', () => {
                if (drawer.classList.contains('open')) {
                    drawer.classList.remove('open');
                    menuToggle.setAttribute('aria-expanded', 'false');
                }
            });
            drawer.addEventListener('click', (e) => e.stopPropagation());
        })();

        function render() {
            const key = 'sales_summary';
            const listEl = document.getElementById('list');
            listEl.innerHTML = '';
            const raw = localStorage.getItem(key);
            if (!raw) {
                listEl.innerHTML = '<p>No transactions yet.</p>';
                return;
            }
            let arr = [];
            try { arr = JSON.parse(raw); } catch (e) { listEl.innerHTML = '<p>Failed to read sales summary.</p>'; return; }
            if (!arr.length) { listEl.innerHTML = '<p>No transactions yet.</p>'; return; }
            // show newest first
            arr.slice().reverse().forEach(txn => {
                const node = document.createElement('div');
                node.className = 'txn';
                const when = new Date(txn.timestamp).toLocaleString();
                const h = document.createElement('h4');
                h.textContent = `Table: ${txn.table} ‚Äî ${when} ‚Äî Total: ‚Çπ${txn.total}`;
                node.appendChild(h);
                const pre = document.createElement('pre');
                pre.textContent = txn.items.map(i => `${i.name} x ${i.qty} = ‚Çπ${i.total}`).join('\n');
                node.appendChild(pre);
                listEl.appendChild(node);
            });
        }

        document.getElementById('backBtn').addEventListener('click', () => { window.history.back(); });
        document.getElementById('clearBtn').addEventListener('click', () => {
            if (!confirm('Clear all saved sales?')) return;
            localStorage.removeItem('sales_summary');
            render();
        });

        render();
    </script>
</body>
</html>